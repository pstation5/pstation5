<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>Horror Games Community</title>

  <link rel="icon" href="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20100%20100'%3E%3Ctext%20y='.9em'%20font-size='90'%3E%F0%9F%91%BB%3C/text%3E%3C/svg%3E">
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <link rel="stylesheet" href="style.css"/>
</head>

<body>
  <div class="app-container">
    <header class="header">
      <div class="header-left">
        <div class="logo">
          <i class="fas fa-ghost"></i>
          <h1>Horror Games</h1>
        </div>
        <p class="subtitle">Сообщество коллекционеров хоррор-игр</p>
      </div>

      <div class="header-right">
        <div class="user-profile">
          <img id="userAvatar" class="user-avatar" alt="Avatar" src=""/>
          <div class="user-info">
            <span id="userGreeting" class="user-name">Привет!</span>
            <span id="userRole" class="user-status">Пользователь</span>
          </div>
        </div>

        <div class="header-actions">
          <button class="my-collection-btn" onclick="openMyCollection()" title="Моя коллекция">
            <i class="fas fa-heart"></i> Моя коллекция
          </button>

          <button class="theme-toggle" onclick="toggleTheme()" title="Смена темы">
            <i class="fas fa-moon" id="themeIcon"></i>
          </button>
        </div>
      </div>
    </header>

    <main class="main-content">
      <div class="tabs">
        <button class="tab-btn active" onclick="switchTab('all-games')">Все игры</button>
        <button class="tab-btn" onclick="switchTab('top-rated')">Топовые</button>
        <button class="tab-btn" onclick="switchTab('recent-comments')">Обсуждаемые</button>
      </div>

      <section class="stats-section">
        <div class="stats">
          <div class="stat-item">
            <i class="fas fa-gamepad"></i>
            <div class="stat-number" id="totalGames">0</div>
            <div class="stat-label">Всего игр</div>
          </div>

          <div class="stat-item">
            <i class="fas fa-comments"></i>
            <div class="stat-number" id="totalComments">0</div>
            <div class="stat-label">Комментариев</div>
          </div>

          <div class="stat-item">
            <i class="fas fa-users"></i>
            <div class="stat-number" id="totalUsers">0</div>
            <div class="stat-label">Коллекционеров</div>
          </div>

          <div class="stat-item">
            <i class="fas fa-star"></i>
            <div class="stat-number" id="avgRating">0.0</div>
            <div class="stat-label">Средняя оценка</div>
          </div>
        </div>
      </section>

      <section class="collection-section">
        <div class="section-header">
          <h2><i class="fas fa-archive"></i> Каталог игр</h2>
          <div id="adminControls" style="display: none;">
            <button class="add-game-btn" onclick="openAddGameModal()">
              <i class="fas fa-plus"></i> Добавить игру
            </button>
          </div>
        </div>

        <div class="filters-section">
          <div class="search-box">
            <i class="fas fa-search"></i>
            <input id="searchInput" type="text" placeholder="Поиск по названию..."/>
          </div>

          <div class="filter-controls">
            <select id="platformFilter">
              <option value="">Все платформы</option>
            </select>

            <select id="genreFilter">
              <option value="">Все жанры</option>
              <option value="survival-horror">Survival Horror</option>
              <option value="psychological-horror">Psychological Horror</option>
              <option value="sci-fi-horror">Sci-Fi Horror</option>
              <option value="action-horror">Action Horror</option>
            </select>

            <select id="sortSelect">
              <option value="title">По названию</option>
              <option value="rating">По оценке</option>
              <option value="year">По году</option>
              <option value="comments">По комментариям</option>
            </select>
          </div>
        </div>

        <div class="game-grid" id="gameGrid"></div>

        <div class="pagination">
          <button class="page-btn" onclick="prevPage()">
            <i class="fas fa-chevron-left"></i>
          </button>
          <span class="page-info">
            Страница <span id="currentPage">1</span> из <span id="totalPages">1</span>
          </span>
          <button class="page-btn" onclick="nextPage()">
            <i class="fas fa-chevron-right"></i>
          </button>
        </div>
      </section>
    </main>

    <!-- Add Game Modal (Admin only) -->
    <div class="modal" id="addGameModal">
      <div class="modal-content">
        <div class="modal-header">
          <h2><i class="fas fa-plus"></i> Добавить игру</h2>
          <button class="close-modal" onclick="closeAddGameModal()"><i class="fas fa-times"></i></button>
        </div>

        <div class="modal-body">
          <form id="addGameForm">
            <div class="form-group">
              <label>Название игры *</label>
              <input id="gameTitle" type="text" required placeholder="Введите название"/>
            </div>

            <div class="form-group">
              <label>Платформа *</label>
              <select id="gamePlatform" required>
                <option value="">Выберите платформу</option>
                <option value="ps5">PlayStation 5</option>
                <option value="ps4">PlayStation 4</option>
                <option value="pc">PC</option>
                <option value="xbox">Xbox Series X/S</option>
                <option value="switch">Nintendo Switch</option>
              </select>
            </div>

            <div class="form-group">
              <label>Обложка (URL) *</label>
              <input id="gameCover" type="url" required placeholder="https://images.igdb.com/..."/>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label>Год релиза *</label>
                <input id="gameYear" type="number" min="1990" max="2030" required/>
              </div>

              <div class="form-group">
                <label>Жанр *</label>
                <select id="gameGenre" required>
                  <option value="">Выберите жанр</option>
                  <option value="survival-horror">Survival Horror</option>
                  <option value="psychological-horror">Psychological Horror</option>
                  <option value="sci-fi-horror">Sci-Fi Horror</option>
                  <option value="action-horror">Action Horror</option>
                  <option value="horror">Horror</option>
                </select>
              </div>
            </div>

            <div class="form-group">
              <label>Разработчик</label>
              <input id="gameDeveloper" type="text" placeholder="Например: Capcom"/>
            </div>

            <div class="form-group">
              <label>Издатель</label>
              <input id="gamePublisher" type="text" placeholder="Например: Konami"/>
            </div>

            <div class="form-group">
              <label>Описание</label>
              <textarea id="gameDescription" rows="4" placeholder="Краткое описание игры..."></textarea>
            </div>

            <div class="modal-actions">
              <button type="button" class="btn-secondary" onclick="closeAddGameModal()">Отмена</button>
              <button type="submit" class="btn-primary"><i class="fas fa-save"></i> Добавить игру</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Game Detail Modal -->
    <div class="modal" id="gameDetailModal">
      <div class="modal-content modal-large">
        <div class="modal-header">
          <h2 id="detailTitle">Детали игры</h2>
          <button class="close-modal" onclick="closeGameDetailModal()"><i class="fas fa-times"></i></button>
        </div>
        <div class="modal-body" id="gameDetailContent"></div>
      </div>
    </div>

    <!-- Comment Modal -->
    <div class="modal" id="commentModal">
      <div class="modal-content">
        <div class="modal-header">
          <h2><i class="fas fa-comment"></i> Добавить комментарий</h2>
          <button class="close-modal" onclick="closeCommentModal()"><i class="fas fa-times"></i></button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label>Ваша оценка</label>
            <div class="rating-stars" id="commentRating">
              <span class="star" data-value="1">★</span>
              <span class="star" data-value="2">★</span>
              <span class="star" data-value="3">★</span>
              <span class="star" data-value="4">★</span>
              <span class="star" data-value="5">★</span>
              <span class="star" data-value="6">★</span>
              <span class="star" data-value="7">★</span>
              <span class="star" data-value="8">★</span>
              <span class="star" data-value="9">★</span>
              <span class="star" data-value="10">★</span>
            </div>
            <input type="hidden" id="selectedRating" value="0">
          </div>
          
          <div class="form-group">
            <label>Комментарий *</label>
            <textarea id="commentText" rows="4" required placeholder="Поделитесь вашим мнением об игре..."></textarea>
          </div>

          <div class="modal-actions">
            <button type="button" class="btn-secondary" onclick="closeCommentModal()">Отмена</button>
            <button type="button" class="btn-primary" onclick="submitComment()"><i class="fas fa-paper-plane"></i> Отправить</button>
          </div>
        </div>
      </div>
    </div>

    <!-- My Collection Modal -->
    <div class="modal" id="collectionModal">
      <div class="modal-content">
        <div class="modal-header">
          <h2><i class="fas fa-heart"></i> Моя коллекция</h2>
          <button class="close-modal" onclick="closeCollectionModal()"><i class="fas fa-times"></i></button>
        </div>
        <div class="modal-body">
          <div class="game-grid" id="collectionGrid"></div>
          <div id="emptyCollection" style="text-align: center; padding: 40px; color: var(--text-secondary);">
            <i class="fas fa-gamepad" style="font-size: 3rem; margin-bottom: 20px;"></i>
            <p>Ваша коллекция пуста</p>
            <p style="font-size: 0.9rem;">Добавляйте игры из каталога!</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="script.js"></script>
</body>
</html>
